(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function i(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(t){if(t.ep)return;t.ep=!0;const r=i(t);fetch(t.href,r)}})();let h,c,l=0,w,S,A=5,T="",C="";const X="7848894783:AAFvnM3F_EjUx4Jg96eLMh7spmC2m1Dm81I",Y="380071850";let $="",z="";const E="https://api-loyalty.therealreward.com",G="E2ejhMb8pnNcm3nmyU4eaQzW4n02s5nd",Z="2wK2xE6kJo3MeNv2";let _="",f=[],j="PUBLISHED",ee=Phaser.Math.FloatBetween(2,43);const te={type:Phaser.AUTO,width:690,height:window.innerHeight+30,parent:"game-container",resolution:2,scene:{preload:ae,create:ne,update:oe}};let g=[{val:-1,label:"Jelly 1 Stick",code:"C001",weight:0,img:"reward_r001"},{val:-2,label:"Tote Bag",code:"C002",weight:0,img:"reward_r002"},{val:-3,label:"Sakkin Kid",code:"C003",weight:0,img:"reward_r003"},{val:-4,label:"Sakkin 100ml",code:"C004",weight:0,img:"reward_r004"},{val:3,label:"Sakkin Veggie",code:"C005",weight:0,img:"reward_r005"},{val:1,label:"Aojiru 1 Box",code:"C006",weight:0,img:"reward_r006"},{val:2,label:"Aojiru Gift $10",code:"C007",weight:0,img:"reward_r007"},{val:0,label:"Voucher $100",code:"C008",weight:0,img:"reward_r008"}];function O(s){return new URLSearchParams(window.location.search).get(s)}function N(s){const e=CryptoJS.enc.Utf8.parse(G),i=CryptoJS.enc.Utf8.parse(Z);return CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(s),e,{keySize:128/8,iv:i,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString()}const se=O("_t"),M=O("_tcode"),D=O("_bcode"),P=O("_min"),v=atob(se);var W;const q=(W=v==null?void 0:v.split("-"))==null?void 0:W.pop(),F=v.substring(0,v.lastIndexOf("-"));M&&(C=M);D&&(T=D);P&&(A=parseInt(P)-1);F&&q?($=F,z=q):window.location.href="404";async function J(){var s,e;try{let i={key:N.call(this,$),secret:N.call(this,z)};const a=await axios.post(`${E}/partner/v1/login`,i,{headers:{"Content-Type":"application/json"}});a.data.response.status>=400&&(window.location.href="404"),a.data.response.status==200&&(_=(e=(s=a.data)==null?void 0:s.results)==null?void 0:e.token)}catch(i){console.error("Error fetching data:",i)}}async function R(){try{await J.call(),f=(await axios.post(`${E}/partner/v1/lucky-reward`,"",{headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`}})).data.results;let e=localStorage.getItem("rewardLinks");if(e){let i=e==null?void 0:e.split(",");for(let a=0;a<i.length;a++)U.call(this,f,i[a],"CLAIMED")}await fe.call(),console.log("rewardList ",g)}catch(s){console.error("Error fetching data:",s)}}async function ie(s){try{return await J.call(),(await axios.post(`${E}/partner/v1/lucky-reward/check`,{key:s},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`}})).data.results.code}catch(e){console.error("Error fetching data:",e)}}function ae(){re.call(this),this.load.audio("introSound","assets/audios/intro.mp3"),this.load.audio("collectSound","assets/audios/collect.mp3"),this.load.audio("spinSound","assets/audios/spinSound.mp3"),this.load.image("shareToTelegramBtn","assets/images/share.png"),this.load.image("fullscreenIcon","assets/images/fullscreen.png"),this.load.image("resetIcon","assets/images/reset.png"),this.load.image("scanIcon","assets/images/scan.png"),this.load.image("activeIcon","assets/images/active.png"),this.load.image("forceCloseBtn","assets/images/forceClose.png"),this.load.image("reload","assets/images/reload.png"),this.load.image("background","assets/images/background.png"),this.load.image("wheel","assets/images/wheel.png"),this.load.image("bgWheelTop","assets/images/bgWheelTop.png"),this.load.image("bgWheel","assets/images/bgWheel.png"),this.load.image("pin","assets/images/pin.png"),this.load.image("spinButton","assets/images/spinButton.png"),this.load.image("spinButtonDown","assets/images/spinButtonDown.png"),this.load.image("bgReward","assets/images/blur.png"),this.load.image("box","assets/images/box.png"),this.load.image("btnClaim","assets/images/btnClaim.png"),this.load.image("icSound","assets/images/soundOff.png"),this.load.image("icSoundOff","assets/images/sound.png"),this.load.image("bgCoin","assets/images/bgCoin.png"),this.load.image("bgSpinNumber","assets/images/bgSpinNumber.png"),this.load.image("btnAdd","assets/images/add.png"),this.load.image("btnMinus","assets/images/minus.png"),this.load.image("bgScanQR","assets/images/bgScanQR.png"),this.load.image("reward_r001","assets/images/r001.png"),this.load.image("reward_r002","assets/images/r002.png"),this.load.image("reward_r003","assets/images/r003.png"),this.load.image("reward_r004","assets/images/r004.png"),this.load.image("reward_r005","assets/images/r005.png"),this.load.image("reward_r006","assets/images/r006.png"),this.load.image("reward_r007","assets/images/r007.png"),this.load.image("reward_r008","assets/images/r008.png"),this.load.spritesheet("firework","assets/images/firework4.png",{frameWidth:480,frameHeight:480,endFrame:84}),this.load.script("webfont","https://cdnl.iconscout.com/lottie/premium/thumb/chinese-lantern-animated-icon-download-in-lottie-json-gif-static-svg-file-formats--new-year-celebration-decoration-pack-festival-days-icons-8727484.mp4")}function re(){this.cameras.main.setBackgroundColor("#ee3535");const s=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2-30,"Loading: 0%",{font:"20px Arial",fill:"#ffffff"}).setOrigin(.5),e=this.add.graphics(),i=(this.cameras.main.width-200)/2,a=this.cameras.main.height/2,t=200,r=10,o=5;e.fillStyle(16777215,.5),e.fillRoundedRect(i,a,t,r,o);const n=this.add.graphics();this.load.on("progress",u=>{n.clear(),n.fillStyle(16777215,1),n.fillRoundedRect(i,a,t*u,r,o),s.setText(`Loading: ${Math.round(u*100)}%`)}),this.load.on("complete",()=>{n.destroy(),e.destroy(),s.destroy()}),this.load.on("complete",()=>{n.destroy(),e.destroy(),s.destroy()})}async function ne(){let s=!0;await R.call(),await L.call();const e=this.sound.add("introSound"),i=this.sound.add("collectSound"),a=this.sound.add("spinSound");this.add.image(this.cameras.main.centerX,this.cameras.main.centerY,"background").setOrigin(.5,.5).setDisplaySize(this.cameras.main.width,this.cameras.main.height);const t=this.add.sprite(20,160,"icSound");t.setOrigin(0,0),t.setScale(1);const r=this.add.sprite(150,24,"reload");r.setScale(.34),r.setOrigin(1,0),r.setInteractive(),r.on("pointerdown",()=>{R.call(this)});const o=this.add.sprite(130,100,"resetIcon");o.setOrigin(1,0),o.setInteractive(),o.on("pointerdown",()=>{Q.call(this),R.call()});const n=this.add.sprite(this.cameras.main.width-350,50,"fullscreenIcon");n.setScale(.9),n.setInteractive(),n.on("pointerdown",()=>{try{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()}catch(B){console.error(`Fullscreen request failed: ${B.message}`)}}),S=this.add.sprite(this.cameras.main.width-260,50,"scanIcon"),S.setInteractive(),S.on("pointerdown",()=>{I.call(this)?he.call(this):p.call(this,"No Reward")}),this.add.sprite(this.cameras.main.width-110,50,"bgSpinNumber");const u=this.add.sprite(this.cameras.main.width-50,50,"btnAdd");u.setScale(.7),u.setInteractive(),u.on("pointerdown",()=>{l||(l=0),l=parseInt(l)+1,localStorage.setItem("spinNumber",l),L.call(),w.setText(`${l}`)}),w=this.add.text(this.cameras.main.width-85,38,`${l}`,{font:"24px Arial",fill:"#FFFFFF"}),w.setOrigin(.5,0);const y=this.add.sprite(this.cameras.main.width-120,50,"btnMinus");y.setScale(.7),y.setInteractive(),y.on("pointerdown",()=>{l>0&&(l=l-1),localStorage.setItem("spinNumber",l),L.call(),w.setText(`${l}`)});const k=this.add.sprite(this.cameras.main.width/2,270,"bgWheelTop");k.setScale(.8),k.setOrigin(.5,.5);const b=this.add.sprite(this.cameras.main.width/2,530,"wheel");b.setScale(.67),b.setOrigin(.5,.5);const x=this.add.sprite(this.cameras.main.width/2,530,"bgWheel");x.setScale(.74),x.setOrigin(.5,.5),c=this.add.sprite(this.cameras.main.width/2,this.cameras.main.height-100,"spinButton"),c.setScale(.4),c.setOrigin(.5,1),c.setInteractive(),c.on("pointerdown",()=>{c.setTexture("spinButtonDown")}),c.on("pointerup",le.bind(this,b,a,i,p)),c.on("pointerout",()=>{c.setTexture("spinButton")}),t.setInteractive(),t.on("pointerdown",()=>{s=!s,e.setMute(s),i.setMute(s),a.setMute(s),s?t.setTexture("icSound"):(t.setTexture("icSoundOff"),e.play({loop:!0}))})}function oe(){}new Phaser.Game(te);function le(s,e,i,a){if(l<1){a("Please Top up to spin!");return}c.setTexture("spinButton"),c.disableInteractive();let t=localStorage.getItem("rewardLinks"),r=!1,o=!1,n="";if(t){let d=t==null?void 0:t.split(",");for(let m=0;m<d.length;m++)if(me.call(this,f,d[m])){r=!0;break}for(let m=0;m<d.length;m++)if(ue.call(this,f,d[m])){o=!0;break}}console.log("rewards length ",t==null?void 0:t.split(",").length);const u=g.find(d=>d.code==C),y=g.find(d=>T.split(",").includes(d.code));if((t==null?void 0:t.split(",").length)>=A&&!o&&u.weight>0?n=g.find(d=>d.code==C):(t==null?void 0:t.split(",").length)>=10&&!r&&y.weight>0?n=g.find(d=>T.split(",").includes(d.code)):n=ce(g),console.log("selectedReward ",n),n==null){a.call(this,"Reward was gone!"),c.setInteractive();return}const k=g.indexOf(n),b=360/g.length,x=ee,B=k*b+x,H=360*Phaser.Math.Between(2,4)+B;this.tweens.add({targets:s,angle:H,ease:Phaser.Math.Easing.Cubic.Out,duration:Phaser.Math.Between(4e3,5e3),onStart:()=>e.play(),onComplete:()=>{e.stop(),i.play(),de.call(this,n)}})}function ce(s){let e=localStorage.getItem("rewardLinks"),i=s;(!e||(e==null?void 0:e.split(",").length)<A)&&(i=s.filter(r=>r.code!=C)),console.log("_rewardList ",i);const a=i.reduce((r,o)=>r+o.weight,0);let t=Math.random()*a;for(const r of i){if(t<r.weight)return r;t-=r.weight}}function de(s){console.log("reward ",s.code);let e=f.find(n=>n.ref==s.code).item;e=e.filter(n=>n.status==j);let i=e[0].data;this.anims.create({key:"fireworkAnim",frames:this.anims.generateFrameNumbers("firework",{frames:[...Array(84).keys()]}),frameRate:24,repeat:-1}),we.call(this,i),U.call(this,f,i,"CLAIMED"),V.call();const a=this.add.sprite(80,100,"firework");a.play("fireworkAnim",!0),a.setDepth(1e3),a.setDisplaySize(0,0);const t=this.add.sprite(this.cameras.main.width-80,100,"firework");t.play("fireworkAnim",!0),t.setDepth(1e3),t.setDisplaySize(0,0);const r=this.add.image(this.cameras.main.centerX,this.cameras.main.centerY,"bgReward");r.setOrigin(.5,.5),r.setDisplaySize(this.cameras.main.width,this.cameras.main.height);const o=this.add.sprite(this.cameras.main.width/2,this.cameras.main.height/2-100,`${s.img}`);o.setOrigin(.5,.5),o.setScale(.5),setTimeout(()=>{r.destroy(),o.destroy(),a.destroy(),t.destroy(),h&&(h.destroy(),h=null,this.textures.exists("qrCanvas")&&this.textures.remove("qrCanvas")),c.setInteractive()},4e3)}function he(){S.disableInteractive(),this.anims.create({key:"fireworkAnim",frames:this.anims.generateFrameNumbers("firework",{frames:[...Array(84).keys()]}),frameRate:24,repeat:-1});const s=this.add.sprite(80,100,"firework");s.play("fireworkAnim",!0),s.setDepth(1e3),s.setDisplaySize(0,0);const e=this.add.sprite(this.cameras.main.width-80,100,"firework");e.play("fireworkAnim",!0),e.setDepth(1e3),e.setDisplaySize(250,250);const i=this.add.image(this.cameras.main.centerX,this.cameras.main.centerY,"bgReward");i.setOrigin(.5,.5),i.setDisplaySize(this.cameras.main.width,this.cameras.main.height);const a=this.add.sprite(this.cameras.main.width/2,this.cameras.main.height/2-130,"bgScanQR");a.setOrigin(.5,.5),a.setScale(.25),pe.call(this,I.call(this),a);const t=this.add.image(this.cameras.main.centerX,this.cameras.main.height-220,"btnClaim");t.setOrigin(.5,.5),t.setScale(.25),t.setInteractive();const r=this.add.sprite(this.cameras.main.width-50,50,"forceCloseBtn");r.setOrigin(.5,.5),r.setScale(1),r.setInteractive();const o=this.add.sprite(this.cameras.main.width-120,50,"shareToTelegramBtn");o.setOrigin(.5,.5),o.setScale(1),o.setInteractive(),o.on("pointerdown",()=>{const n=I.call(this);if(console.log("Text to copy:",n),!n){console.error("No text available to copy.");return}ge.call(this,n)}),t.on("pointerdown",async()=>{let n=await ie.call(this,I.call(this));if(!n){p("Something went wrong");return}if(n=="00"){p("Reward Not Claimed");return}else if(n=="02"){p("Reward link is invalid");return}Q.call(this),await R.call(),p("Claim Success!"),i.destroy(),a.destroy(),t.destroy(),s.destroy(),e.destroy(),o.destroy(),r.destroy(),h&&(h.destroy(),h=null,this.textures.exists("qrCanvas")&&this.textures.remove("qrCanvas")),c.setInteractive(),V.call()}),r.on("pointerdown",async()=>{i.destroy(),a.destroy(),t.destroy(),s.destroy(),e.destroy(),r.destroy(),o.destroy(),S.setInteractive(),h&&(h.destroy(),h=null,this.textures.exists("qrCanvas")&&this.textures.remove("qrCanvas")),c.setInteractive()})}function ge(s=""){const e=`https://api.telegram.org/bot${X}/sendMessage`;fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:Y,text:s})}).then(i=>i.json()).then(i=>{i.ok?(console.log("Message sent successfully:",i.result),p("Sent Successfully!")):console.error("Error sending message:",i)}).catch(i=>console.error("Error:",i))}function U(s,e,i){s.forEach(a=>{a.item.forEach(t=>{t.data.includes(e)&&(t.status=i)})})}function me(s,e){let i=T.split(",");return s.some(a=>a.item.some(t=>!!(t.data.includes(e)&&i.includes(a.ref))))}function ue(s,e){return s.some(i=>i.item.some(a=>!!(a.data.includes(e)&&i.ref===C)))}function pe(s,e){const i=new QRious({value:s,size:420,level:"L"}),a=new Image;a.src=i.toDataURL(),a.onload=()=>{const t=this.textures.createCanvas("qrCanvas",a.width,a.height);t.context.drawImage(a,0,0),t.refresh(),h=this.add.image(e.x,e.y+e.displayHeight/2-30,"qrCanvas"),h.setOrigin(.5,1)},a.onerror=()=>{console.error("Failed to load QR code image.")}}function L(){const s=localStorage.getItem("spinNumber");s&&(l=s),c&&(l==0?c.disableInteractive():c.setInteractive())}async function fe(){g=g.map(s=>{let e=f.find(a=>a.ref===s.code);const i=e?e.item.filter(a=>a.status===j).length:0;return{...s,weight:i}})}function V(){l&&l>0?l=l-1:l=0,c&&(l==0?c.disableInteractive():c.setInteractive()),localStorage.setItem("spinNumber",l),w.setText(`${l}`)}function p(s){const e=document.getElementById("toast");e.textContent=s,e.classList.add("show"),setTimeout(()=>{e.classList.remove("show")},3e3)}function we(s){let e=I.call(this),i=(e==null?void 0:e.split(","))||[];i.push(s),localStorage.setItem("rewardLinks",i.join(","))}function I(){return localStorage.getItem("rewardLinks")}function Q(){localStorage.removeItem("spinNumber"),l=0,w.setText("0"),localStorage.removeItem("rewardLinks")}
